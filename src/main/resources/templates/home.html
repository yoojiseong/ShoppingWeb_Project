<!DOCTYPE html>
<html lang="ko"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fashion Store - ë©”ì¸</title>
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous">
</head>
<body>
<header class="header">
    <div class="container">
        <div class="logo">
            <h1><a href="/home">Fashion Store</a></h1>
        </div>
        <nav class="nav">
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="ìƒí’ˆì„ ê²€ìƒ‰í•˜ì„¸ìš”...">
                <button onclick="searchProducts()">ê²€ìƒ‰</button>
            </div>
            <div class="nav-buttons">
                <button onclick="goToMyPage()">ë§ˆì´í˜ì´ì§€</button>
                <button onclick="goToCart()">ì¥ë°”êµ¬ë‹ˆ (<span id="cartCount">0</span>)</button>
                <button onclick="goToLogin()" id="loginBtn">ë¡œê·¸ì¸</button>
                <button onclick="goToSignup()">íšŒì›ê°€ì…</button>
                <button onclick="logout()" id="logoutBtn" style="display: none;">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </nav>
    </div>
</header>

<main class="main">
    <div class="container">
        <section class="categories">
            <h2>ì¹´í…Œê³ ë¦¬</h2>
            <div class="category-grid">
                <div class="category-card" onclick="filterByCategory('í•˜ì˜')">
                    <h3>ë°”ì§€</h3>
                    <p>í¸ì•ˆí•œ ë°”ì§€ ì»¬ë ‰ì…˜</p>
                </div>
                <div class="category-card" onclick="filterByCategory('ì‹ ë°œ')">
                    <h3>ì‹ ë°œ</h3>
                    <p>ìŠ¤íƒ€ì¼ë¦¬ì‹œí•œ ì‹ ë°œ</p>
                </div>
                <div class="category-card" onclick="filterByCategory('ìƒì˜')">
                    <h3>ìƒì˜</h3>
                    <p>íŠ¸ë Œë””í•œ ìƒì˜</p>
                </div>
                <div class="category-card" onclick="filterByCategory('ì•„ìš°í„°')">
                    <h3>ì•„ìš°í„°</h3>
                    <p>ë”°ëœ»í•œ ì•„ìš°í„°</p>
                </div>
                <div class="category-card" onclick="filterByCategory('ì›í”¼ìŠ¤')">
                    <h3>ì›í”¼ìŠ¤</h3>
                    <p>ì§€ê¸ˆ ì•„ë‹ˆë©´ ëª»ì‚¬ì¦Œ ì›í”¼ìŠ¤</p>
                </div>
                <div class="category-card" onclick="filterByCategory('ê°€ë°©')">
                    <h3>ê°€ë°©</h3>
                    <p>ì•„ì§ë„ ë°±íŒ© ë§¤ê³  ë‹¤ë‹ˆê²Œ?</p>
                </div>
                <div class="category-card" onclick="filterByCategory('ì•¡ì„¸ì„œë¦¬')">
                    <h3>ì•…ì„¸ì„œë¦¬</h3>
                    <p>ì•…ì„¸ì„œë¦¬ í•˜ë‚˜ë§Œìœ¼ë¡œ ë¶„ìœ„ê¸°ë¥¼ ë‹¤ë¥´ê²Œ</p>
                </div>
                <div class="category-card" onclick="filterByCategory('ê¸°íƒ€/ì•Œ ìˆ˜ ì—†ìŒ')">
                    <h3>ê¸°íƒ€/ì•Œ ìˆ˜ ì—†ìŒ</h3>
                    <p>ë‹¤ë¥¸ ì‡¼í•‘ëª° ê°ˆ í•„ìš” ì—†ì´ ì—¬ê¸°ì„œ ì›í´ë¦­ìœ¼ë¡œ!</p>
                </div>
            </div>
        </section>

        <section class="products">
            <div class="products-header">
                <h2>ìƒí’ˆ ëª©ë¡</h2>
                <button onclick="showAllProducts()" class="show-all-btn">ì „ì²´ ë³´ê¸°</button>
            </div>
            <div class="product-grid" id="productGrid">
                <!-- ìƒí’ˆë“¤ì´ JavaScriptë¡œ ë™ì  ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </section>
    </div>
</main>

<footer class="footer">
    <div class="container">
        <p>&copy; 2024 Fashion Store. All rights reserved.</p>
    </div>
</footer>


<script layout:fragment="script" th:inline="javascript">
    const products = /*[[${products}]]*/ [];
    console.log("ğŸ“¦ products from server:", products);

    displayProducts(products);

    // ìƒí’ˆ í‘œì‹œ (home.html)
    function displayProducts(productsToShow) {
        const productGrid = document.getElementById('productGrid');
        if (!productGrid) return;
        productGrid.innerHTML = '';
        productsToShow.forEach(product => {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            productCard.innerHTML = `
            <div class="product-image">${product.image || 'ì´ë¯¸ì§€ ì—†ìŒ'}</div>
            <div class="product-info">
                <h3 onclick="goToProductDetail(${product.id})">${product.productName}</h3> <!-- product.nameìœ¼ë¡œ ë³€ê²½ -->
                <p>ì¹´í…Œê³ ë¦¬: ${product.productTag}</p> <!-- product.categoryë¡œ ë³€ê²½ -->
                <div class="product-price">${product.price.toLocaleString()}ì›</div>
                <button class="add-to-cart-btn" onclick="addToCart(${product.id})">
                    ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸°
                </button>
            </div>
        `;
            productGrid.appendChild(productCard);
        });
    }

    function filterByCategory(category) {

        let filteredProducts = products.filter(product => {
            return product.productTag === category;
        });

        displayProducts(filteredProducts);
    }


    // ì „ì²´ ìƒí’ˆ ë³´ê¸° (home.html)
    function showAllProducts() {
        filteredProducts = products;
        displayProducts(products);
    }

    // ìƒí’ˆ ê²€ìƒ‰ (home.html)
    function searchProducts() {
        const searchInput = document.getElementById('searchInput');
        const searchTerm = searchInput.value.toLowerCase().trim();
        if (searchTerm === '') {
            displayProducts(products);
            return;
        }
        const searchResults = products.filter(product =>
            product.name.toLowerCase().includes(searchTerm) ||
            product.category.toLowerCase().includes(searchTerm)
        );
        displayProducts(searchResults);
    }
</script>
<script src="/js/script.js"></script>
</body>
</html>